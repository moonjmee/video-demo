<!DOCTYPE html>
<html lang="en">

<head>
    <title>Video Player</title>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.js" integrity="sha256-HwWONEZrpuoh951cQD1ov2HUK5zA5DwJ1DNUXaM6FsY=" crossorigin="anonymous"></script>
    <link href="https://vjs.zencdn.net/7.10.2/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/7.10.2/video.min.js"></script>

    <link href="https://unpkg.com/@silvermine/videojs-quality-selector/dist/css/quality-selector.css" rel="stylesheet">
    <script src="https://unpkg.com/@silvermine/videojs-quality-selector/dist/js/silvermine-videojs-quality-selector.min.js"></script>

    <style>
        .video-container {
            display: flex;
        }

        .video-js {
            flex: 1;
            margin-right: 10px;
        }
    </style>
</head>

<body>
<h1>Mission Impossible 3</h1>
<h2>Left: Elemental H.264, Right: Cloud H.264 </h2>

<div class="video-container">
    <video id="video1" class="video-js vjs-default-skin" controls autoplay muted>
    </video>

    <video id="video2" class="video-js vjs-default-skin" controls autoplay muted>
    </video>
</div>

<script>
    $(document).ready(function() {
        let options = {
            sources: [
                {src: "/video/play", type: "video/mp4"}
            ],
            playbackRates: [.75, 1, 1.5, 2],
            poster: "[이미지 주소 등록]",
            controls: true,
            preload: "auto",
            width: 1920,
            height: 540,
            controlBar: {
                playToggle: true,
                pictureInPictureToggle: false,
                remainingTimeDisplay: true,
                progressControl: true,
                qualitySelector: true,
            }
        };

        var player1 = videojs('video1', options);
        player1.src([
            {
                src: "contents/MissionImpossible3_MO-FHD-H264.mp4",
                type: 'video/mp4',
                label: 'FHD',
                selected: true,
            },
            {
                src: "contents/MissionImpossible3_MO-HD-H264.mp4",
                type: 'video/mp4',
                label: 'HD',
            },
            {
                src: "contents/MissionImpossible3_MO-SD-H264.mp4",
                type: 'video/mp4',
                label: 'SD',
            }
        ]);

        var player2 = videojs('video2', options);
        player2.src([
            {
                src: "contents/MissionImpossible3_MO-FHD-H264_Cloud.mp4",
                type: 'video/mp4',
                label: 'FHD',
                selected: true,
            },
            {
                src: "contents/MissionImpossible3_MO-HD-H264_Cloud.mp4",
                type: 'video/mp4',
                label: 'HD',
            },
            {
                src: "contents/MissionImpossible3_MO-SD-H264_Cloud.mp4",
                type: 'video/mp4',
                label: 'SD',
            },
        ]);
        player2.on('loadeddata', function() {
            $('.vjs-loading-spinner').hide();
        });
    })

    var video1 = document.getElementById('video1');
    var video2 = document.getElementById('video2');

    video1.addEventListener('loadedmetadata', function() {
        synchronizeVideos();
    });

    video1.addEventListener('timeupdate', function() {
        synchronizeVideos();
    });

    video2.addEventListener('timeupdate', function() {
        synchronizeVideos();
    });

    function synchronizeVideos() {
        var currentTime = video1.currentTime;
        if (video2.currentTime !== currentTime) {
            video2.currentTime = currentTime;
        }
    }
</script>


</body>
</html>