<!DOCTYPE html>
<html lang="en">

<head>
    <title>Video Player</title>
    <script src="https://code.jquery.com/jquery-3.6.0.slim.js" integrity="sha256-HwWONEZrpuoh951cQD1ov2HUK5zA5DwJ1DNUXaM6FsY=" crossorigin="anonymous"></script>
    <link href="https://vjs.zencdn.net/7.10.2/video-js.css" rel="stylesheet" />
    <script src="https://vjs.zencdn.net/7.10.2/video.min.js"></script>

    <link href="https://unpkg.com/@silvermine/videojs-quality-selector/dist/css/quality-selector.css" rel="stylesheet">
    <script src="https://unpkg.com/@silvermine/videojs-quality-selector/dist/js/silvermine-videojs-quality-selector.min.js"></script>

    <style>
        .video-container {
            position: relative;
            width: 100%;
            height: 1080px; /* Fixed height */
        }
        .video-js {
            position: absolute;
            top: 0;
            width: 100%;
            height: 100%;
        }
        .divider {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 2px; /* Width of the divider line */
            background-color: white; /* Color of the divider line */
        }

    </style>
</head>

<body>
    <h1>Seoul Korea (TV-FHD)</h1>
    <h2>Left: Elemental H.264 (16Mbps), Right: Cloud H.264 (16Mbps)</h2>

    <div class="video-container">
        <video id="video1" class="video-js vjs-default-skin" controls autoplay muted></video>
        <video id="video2" class="video-js vjs-default-skin" controls autoplay muted></video>
        <div class="divider"></div> <!-- Divider line -->
    </div>

    <div id="slider-container">
        <input type="range" id="slider" min="0" max="100" value="50">
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() { //$(document).ready(function() {
            var options = {
                sources: [
                {src: "/video/play", type: "video/mp4"}
            ],
                playbackRates: [.75, 1, 1.5, 2],
                poster: "[이미지 주소 등록]",
                controls: true,
                preload: "auto",
                width: 1920,
                height: 1080,
                controlBar: {
                playToggle: true,
                pictureInPictureToggle: false,
                remainingTimeDisplay: true,
                progressControl: true,
                qualitySelector: true,
            }
            };

            var player1 = videojs('video1', options);
            player1.src([
                {
                    src: "contents/SeoulKorea_TV-HD-H264.mp4",
                    type: 'video/mp4',
                    label: 'HD',
                    selected: true,
                },
            ]);

            var player2 = videojs('video2', options);
            player2.src([
                {
                    src: "contents/SeoulKorea_TV-HD-H264_Cloud.mp4",
                    type: 'video/mp4',
                    label: 'HD',
                    selected: true,
                },
            ]);
            player2.on('loadeddata', function () {
                $('.vjs-loading-spinner').hide();
            });

            // 비디오 동기화
            /*player1.on('timeupdate', function() {
                player2.currentTime(player1.currentTime());
            });*/
            // 슬라이더 이벤트
            var slider = document.getElementById('slider');
            var divider = document.querySelector('.divider'); // Get the divider element
            slider.addEventListener('input', function() {
                const value = slider.value;
                const containerWidth = document.querySelector('.video-container').offsetWidth;
                const clipWidth1 = (containerWidth * value / 100);
                const clipWidth2 = containerWidth - clipWidth1;

                player1.el().style.clip = `rect(0px, ${clipWidth1}px, 1080px, 0px)`;
                player2.el().style.clip = `rect(0px, ${containerWidth}px, 1080px, ${clipWidth1}px)`;
                divider.style.left = `${clipWidth1}px`; // Set the position of the divider line
            });
        });
        var video1 = document.getElementById('video1');
        var video2 = document.getElementById('video2');
        video1.addEventListener('loadedmetadata', function() {
            synchronizeVideos();
        });
        video1.addEventListener('timeupdate', function() {
            synchronizeVideos();
        });
        video2.addEventListener('timeupdate', function() {
            synchronizeVideos();
        });
        function synchronizeVideos() {
            var currentTime = video1.currentTime;
            if (video2.currentTime !== currentTime) {
                video2.currentTime = currentTime;
            }
        }
    </script>
</body>
</html>